<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訪問日予約</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
</head>
<body>
    <h3 style="margin:10px; text-align: center;">
        ご連絡ありがとうございます。<br>
        訪問日時のご希望を承ります。
    </h3>
    <form class="w-75 mx-auto" action="https://script.google.com/macros/s/AKfycbz4WcP7cjv0Olhk7pXeVdc-9DaDjlyLMEi6Ukk_s8ziwim2stVY3NB7mAj0-J_M0GiY/exec" method="post">
        <p class="mt-3">お住いのご住所を選んでください<span style="color:#ff0000;">（※必須）</span></p>
        <div>
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="ken" style="width:25%;">
                <option value="北海道">北海道</option>
                <option value="青森県">青森県</option>
                <option value="岩手県">岩手県</option>
                <option value="宮城県">宮城県</option>
                <option value="秋田県">秋田県</option>
                <option value="山形県">山形県</option>
                <option value="福島県">福島県</option>
                <option value="茨城県">茨城県</option>
                <option value="栃木県">栃木県</option>
                <option value="群馬県">群馬県</option>
                <option value="埼玉県">埼玉県</option>
                <option value="千葉県">千葉県</option>
                <option value="東京都">東京都</option>
                <option value="神奈川県">神奈川県</option>
                <option value="山梨県">山梨県</option>
                <option value="長野県">長野県</option>
                <option value="新潟県">新潟県</option>
                <option value="富山県">富山県</option>
                <option value="石川県">石川県</option>
                <option value="福井県">福井県</option>
                <option value="岐阜県">岐阜県</option>
                <option value="静岡県">静岡県</option>
                <option value="愛知県">愛知県</option>
                <option value="三重県">三重県</option>
                <option value="滋賀県">滋賀県</option>
                <option value="京都府">京都府</option>
                <option value="大阪府">大阪府</option>
                <option value="兵庫県">兵庫県</option>
                <option value="奈良県">奈良県</option>
                <option value="和歌山県">和歌山県</option>
                <option value="鳥取県">鳥取県</option>
                <option value="島根県">島根県</option>
                <option value="岡山県">岡山県</option>
                <option value="広島県">広島県</option>
                <option value="山口県">山口県</option>
                <option value="徳島県">徳島県</option>
                <option value="香川県">香川県</option>
                <option value="愛媛県">愛媛県</option>
                <option value="高知県">高知県</option>
                <option value="福岡県">福岡県</option>
                <option value="佐賀県">佐賀県</option>
                <option value="長崎県">長崎県</option>
                <option value="熊本県">熊本県 </option>
                <option value="大分県">大分県</option>
                <option value="宮崎県">宮崎県</option>
                <option value="鹿児島県">鹿児島県</option>
                <option value="沖縄県">沖縄県</option>
            </select>
        </div> 
        <p class="mt-3">お名前<span style="color:#ff0000;">（※必須）</span></p>
        <div>
            <input class="form-control w-100 mt-1" name="name" placeholder="" required>
        </div>
        <p class="mt-3">第１希望日時<span style="color:#ff0000;">（※必須）</span></p>
        <div>
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="month1" style="width:25%;">
                <option value="1">1月</option>
                <option value="2">2月</option>
                <option value="3">3月</option>
                <option value="4">4月</option>
                <option value="5">5月</option>
                <option value="6">6月</option>
                <option value="7">7月</option>
                <option value="8">8月</option>
                <option value="9">9月</option>
                <option value="10">10月</option>
                <option value="11">11月</option>
                <option value="12">12月</option>
            </select>
            &nbsp;&nbsp;            
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="day1" style="width:25%;">
                <option value="1">1日</option>
                <option value="2">2日</option>
                <option value="3">3日</option>
                <option value="4">4日</option>
                <option value="5">5日</option>
                <option value="6">6日</option>
                <option value="7">7日</option>
                <option value="8">8日</option>
                <option value="9">9日</option>
                <option value="10">10日</option>
                <option value="11">11日</option>
                <option value="12">12日</option>
                <option value="13">13日</option>
                <option value="14">14日</option>
                <option value="15">15日</option>
                <option value="16">16日</option>
                <option value="17">17日</option>
                <option value="18">18日</option>
                <option value="19">19日</option>
                <option value="20">20日</option>
                <option value="21">21日</option>
                <option value="22">22日</option>
                <option value="23">23日</option>
                <option value="24">24日</option>
                <option value="25">25日</option>
                <option value="26">26日</option>
                <option value="27">27日</option>
                <option value="28">28日</option>
                <option value="29">29日</option>
                <option value="30">30日</option>
                <option value="31">31日</option>
            </select>
            &nbsp;&nbsp;
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="hour1" style="width:35%;">
                <option value="am">午前中</option>
                <option value="pm0-2">12時～14時</option>
                <option value="pm2-4">14時～16時</option>
                <option value="pm4-6">16時～18時</option>
                <option value="pm6-8">18時～20時</option>
            </select>
        </div>
        <p class="mt-3">第２希望日時（※任意）</p>
        <div>
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="month2" style="width:25%;">
                <option value="1">1月</option>
                <option value="2">2月</option>
                <option value="3">3月</option>
                <option value="4">4月</option>
                <option value="5">5月</option>
                <option value="6">6月</option>
                <option value="7">7月</option>
                <option value="8">8月</option>
                <option value="9">9月</option>
                <option value="10">10月</option>
                <option value="11">11月</option>
                <option value="12">12月</option>
            </select>
            &nbsp;&nbsp;            
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="day2" style="width:25%;">
                <option value="1">1日</option>
                <option value="2">2日</option>
                <option value="3">3日</option>
                <option value="4">4日</option>
                <option value="5">5日</option>
                <option value="6">6日</option>
                <option value="7">7日</option>
                <option value="8">8日</option>
                <option value="9">9日</option>
                <option value="10">10日</option>
                <option value="11">11日</option>
                <option value="12">12日</option>
                <option value="13">13日</option>
                <option value="14">14日</option>
                <option value="15">15日</option>
                <option value="16">16日</option>
                <option value="17">17日</option>
                <option value="18">18日</option>
                <option value="19">19日</option>
                <option value="20">20日</option>
                <option value="21">21日</option>
                <option value="22">22日</option>
                <option value="23">23日</option>
                <option value="24">24日</option>
                <option value="25">25日</option>
                <option value="26">26日</option>
                <option value="27">27日</option>
                <option value="28">28日</option>
                <option value="29">29日</option>
                <option value="30">30日</option>
                <option value="31">31日</option>
            </select>
            &nbsp;&nbsp;
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="hour2" style="width:35%;">
                <option value="am">午前中</option>
                <option value="pm0-2">12時～14時</option>
                <option value="pm2-4">14時～16時</option>
                <option value="pm4-6">16時～18時</option>
                <option value="pm6-8">18時～20時</option>
            </select>
        </div>
        <p class="mt-3">第３希望日時（※任意）</p>
        <div>
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="month3" style="width:25%;">
                <option value="1">1月</option>
                <option value="2">2月</option>
                <option value="3">3月</option>
                <option value="4">4月</option>
                <option value="5">5月</option>
                <option value="6">6月</option>
                <option value="7">7月</option>
                <option value="8">8月</option>
                <option value="9">9月</option>
                <option value="10">10月</option>
                <option value="11">11月</option>
                <option value="12">12月</option>
            </select>
            &nbsp;&nbsp;            
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="day3" style="width:25%;">
                <option value="1">1日</option>
                <option value="2">2日</option>
                <option value="3">3日</option>
                <option value="4">4日</option>
                <option value="5">5日</option>
                <option value="6">6日</option>
                <option value="7">7日</option>
                <option value="8">8日</option>
                <option value="9">9日</option>
                <option value="10">10日</option>
                <option value="11">11日</option>
                <option value="12">12日</option>
                <option value="13">13日</option>
                <option value="14">14日</option>
                <option value="15">15日</option>
                <option value="16">16日</option>
                <option value="17">17日</option>
                <option value="18">18日</option>
                <option value="19">19日</option>
                <option value="20">20日</option>
                <option value="21">21日</option>
                <option value="22">22日</option>
                <option value="23">23日</option>
                <option value="24">24日</option>
                <option value="25">25日</option>
                <option value="26">26日</option>
                <option value="27">27日</option>
                <option value="28">28日</option>
                <option value="29">29日</option>
                <option value="30">30日</option>
                <option value="31">31日</option>
            </select>
            &nbsp;&nbsp;
            <select class="form-select form-select-lg mb-3" aria-label="Default select example" name="hour3" style="width:35%;">
                <option value="午前中">午前中</option>
                <option value="12時-14時">12時～14時</option>
                <option value="14時-16時">14時～16時</option>
                <option value="16時-18時">16時～18時</option>
                <option value="18時-20時">18時～20時</option>
            </select>
        </div>
        <p class="mt-3">その他ご要望（※任意）</p>
        <div>
            <input class="form-control w-100 mt-1" name="sonota">
        </div>
        <p class="mt-3">連絡先TEL<span style="color:#ff0000;">（※必須）</span></p>
        <div>
            <input class="form-control w-100 mt-1" name="tel" required>
        </div>
        <div style="margin:10px; text-align: right;">
            <input type="submit" class="mt-4 btn btn-primary" value="送信">
        </div>    
    </form>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script>
    
        $(document).ready(function () {
            const liffId = "2001788752-1jeGqyr0";
            initializeLiff(liffId);
        })

        function initializeLiff(liffId) {
            liff.init({
                liffId: liffId
            }).then(() => {
                initializeApp();
            }).catch((err) => {
                console.log('LIFF Initialization failed ', err);
            });
        }

        function sendText(text) {
            liff.sendMessages([{
                'type': 'text',
                'text': text
            }]).then(function () {
                liff.closeWindow();
            }).catch(function (error) {
                window.alert('Failed to send message ' + error);
            });
        }

        const params = (new URL(document.location)).searchParams;
        const key = params.get('key');
        
        $(function () {
            $('form').submit(function () {
                const ken = $('select[name="ken"]').val();
                const name = $('input[name="name"]').val();
                const date1 = $('select[name="month1"]').val() + '/' + $('select[name="day1"]').val() + '　' +$('select[name="hour1"]').val();
                const date2 = $('select[name="month2"]').val() + '/' + $('select[name="day2"]').val() + '　' +$('select[name="hour2"]').val();
                const date3 = $('select[name="month3"]').val() + '/' + $('select[name="day3"]').val() + '　' +$('select[name="hour3"]').val();
                const sonota  = $('input[name="sonota"]').val();
                const tel = $('input[name="tel"]').val();
                const msg = `【訪問のご希望日時】\n\n居住地：${ken}\nお名前：${name}\n第一希望日：${date1}\n第二希望日：${date2}\n第三希望日：${date3}\nその他ご要望：${sonota}\n連絡先の電話番号：${tel}`;
                sendText(msg);
                return false;

                //チェックボックス　$("input[name='hobby']:checked").val()
                //テキストエリア　$("textarea[name='profile']").val()
                //idで値取得　$("#occupation").val()
            });
        });

    </script>

</body>
</html>
